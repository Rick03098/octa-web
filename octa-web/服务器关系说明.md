# 本地服务器和 Figma MCP 的关系说明

## 🔍 关键理解

您的项目中有**两个不同的服务器**，它们的作用完全不同：

### 服务器 1：前端开发服务器（Vite）

- **端口**：`5173`（默认）
- **作用**：运行您的 React 前端应用
- **启动命令**：`npm run dev`
- **这是什么**：这是您**项目的服务器**，用于开发前端应用

### 服务器 2：Figma MCP 服务器

- **端口**：`3845`
- **作用**：提供从 Figma 设计文件获取的图片资源
- **启动方式**：由 **Cursor 编辑器**自动管理
- **这是什么**：这是 **Cursor 的 MCP 功能**提供的服务，**不是您项目的代码**

---

## 📊 它们的关系

```
┌─────────────────────────────────────────────────────┐
│  您的 React 前端应用 (localhost:5173)                │
│  由 Vite 开发服务器提供                              │
│                                                     │
│  ┌───────────────────────────────────────────┐    │
│  │ 页面需要加载图片                           │    │
│  │ <img src="http://localhost:3845/assets/..."> │    │
│  └───────────────────────────────────────────┘    │
│              ↓ 请求图片                              │
└─────────────────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────────────┐
│  Figma MCP 服务器 (localhost:3845)                  │
│  由 Cursor 编辑器提供                               │
│  - 从 Figma 设计文件获取图片                         │
│  - 提供 /assets/xxx.png 资源                        │
└─────────────────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────────────┐
│  Figma Desktop 应用                                 │
│  - 提供设计文件访问                                  │
│  - 通过 MCP 协议与 Cursor 通信                       │
└─────────────────────────────────────────────────────┘
```

## 🎯 为什么需要 Figma MCP 服务器？

### 问题场景

您在开发时从 Figma 设计文件中使用了图片资源：

1. **设计阶段**：设计师在 Figma 中设计了界面，包含图片
2. **开发阶段**：您需要在代码中使用这些图片
3. **传统方式**：需要手动从 Figma 导出图片，保存到项目目录
4. **MCP 方式**：Figma MCP 服务器可以动态提供这些图片，无需手动导出

### 工作流程

```
Figma 设计文件 
    ↓
Figma Desktop 应用（运行中）
    ↓
Cursor MCP 连接（自动建立）
    ↓
Figma MCP 服务器（localhost:3845）
    ↓
您的代码：<img src="http://localhost:3845/assets/xxx.png">
```

## ⚠️ 问题的根源

您遇到的问题：

1. **前端服务器（5173）**：正常运行 ✅
   - `npm run dev` 可以正常启动
   - React 应用可以正常访问

2. **Figma MCP 服务器（3845）**：无法连接 ❌
   - `localhost:3845` 服务器没有运行
   - 图片无法加载（因为图片路径指向 `localhost:3845`）

3. **为什么会有这个问题**：
   - 代码中使用了 `localhost:3845` 的图片路径
   - 但 Figma MCP 服务器没有自动启动或连接失败
   - 导致图片无法加载

## ✅ 解决方案

### 方案 1：启动 Figma MCP 服务器（推荐用于开发）

确保 Figma MCP 服务器运行：
1. 打开 Figma Desktop 应用
2. 重启 Cursor 编辑器
3. Cursor 会自动连接 Figma MCP 服务器
4. `localhost:3845` 服务器应该可以访问

### 方案 2：将图片迁移到项目目录（推荐用于生产）

将图片从 Figma MCP 服务器下载到项目的 `public/images/` 目录：
1. 从 `localhost:3845/assets/xxx.png` 下载图片
2. 保存到 `public/images/xxx.png`
3. 修改代码使用 `/images/xxx.png`（相对路径）
4. 这样就不依赖 Figma MCP 服务器了

**我们已经完成了方案 2 的代码修改** ✅
- 所有图片路径已改为 `/images/xxx.png`
- 只需要将图片文件放入 `public/images/` 目录

## 📝 总结

| 项目 | 服务器 1 (5173) | 服务器 2 (3845) |
|------|----------------|-----------------|
| **是什么** | 您的前端应用服务器 | Cursor 的 Figma MCP 服务 |
| **由谁提供** | 您的项目（Vite） | Cursor 编辑器 |
| **作用** | 运行 React 应用 | 提供 Figma 图片资源 |
| **是否需要** | ✅ 必需（开发时） | ⚠️ 可选（如果用 Figma 资源） |
| **如何启动** | `npm run dev` | Cursor 自动管理 |
| **当前状态** | 应该可以正常启动 | 需要确保运行 |

## 🎯 关键要点

1. **两个服务器是独立的**：
   - 前端服务器（5173）运行您的应用
   - Figma MCP 服务器（3845）提供图片资源

2. **Figma MCP 不是您项目的代码**：
   - 它是 Cursor 编辑器的功能
   - 用于在开发时从 Figma 获取资源
   - 不需要部署到生产环境

3. **最佳实践**：
   - **开发时**：可以使用 Figma MCP 获取图片（方便）
   - **生产时**：应该将图片放入项目目录（独立，不依赖外部服务）
   - **分享给同事**：应该使用项目内的图片（其他人可能没有 Figma MCP）

## 🔧 现在您需要做什么？

由于我们已经将代码改为使用 `/images/xxx.png`（相对路径），您有两个选择：

### 选择 1：使用 Figma MCP 服务器（开发时）

1. 启动 Figma MCP 服务器（通过重启 Cursor）
2. 从 `localhost:3845` 下载图片到 `public/images/`
3. 后续可以直接从 Figma 获取新图片

### 选择 2：直接从 Figma 导出（最简单）

1. 打开 Figma 设计文件
2. 导出需要的图片
3. 保存到 `public/images/` 目录
4. 不依赖 Figma MCP 服务器

**推荐选择 2**，因为它最简单，而且不依赖外部服务。
